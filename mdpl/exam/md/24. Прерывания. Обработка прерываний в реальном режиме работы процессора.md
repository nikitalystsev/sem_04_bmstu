# 24. Прерывания. Обработка прерываний в реальном режиме работы процессора.

__Прерывание__ - особая ситуация, когда выполнение текущей программы приостанавливается и управление передаётся программе-обработчику возникшего прерывания. 

Прерывание можно рассматривать как некоторое особое событие в системе, требующее моментальной реакции. Практически все системы ввода/вывода в компьютере работают с использованием прерываний. Например: нажатие клавиши, щелчок мышкой - аппаратура вырабатывает прерывания. В ответ на них система, соответственно, считывает код нажатой клавиши или запоминает координаты курсора мыши. 

### Виды прерываний

+ аппаратные (асинхронные) - события от внешних устройств; 
+ внутренние (синхронные) - события в самом процессоре, например, деление на ноль; 
+ программные - вызванные командой int.



Внешние прерывания, в зависимости от возможности запрета, делятся на: 

+ маскируемые — прерывания, которые можно запрещать установкой соответствующего флага; 
+ немаскируемые (англ. Non-maskable interrupt, NMI) — обрабатываются всегда, независимо от запретов на другие прерывания.



Замаскировать можно прерывания аппаратные(асинхронные) 

Чтобы гарантировать непрерывное выполнение определенной последовательности команд при наличии критических участков можно использовать команду CLI, а в конце расположить команду STI. 

Команда CLI запрещает только маскируемые прерывания, на обработку немаскируемого прерывания эта команда никакого влияния не оказывает. 

IF - флаг прерываний. Сброс этого флага в 0 приводит к тому, что процессор перестает обрабатывать прерывания от внешних устройств.

__CLI__ - Сбрасывает флаг IF в 0.

__SLI__ - Устанавливает флаг IF в 1, отменяя тем самым действие команды CLI.



__Вектор прерывания__ — номер, который идентифицирует соответствующий обработчик прерываний. 

Векторы прерываний объединяются в таблицу векторов прерываний, содержащую адреса обработчиков прерываний. 

+ Располагается в самом начале памяти, начиная с адреса 0. Находится в диапазоне адресов от 0000:0000 до 0000:03FFh 
+ Доступно 256 прерываний. 
+ Каждый вектор занимает 4 байта - полный адрес. 
+ Размер всей таблицы - 1 Кб.

![image-20230614235917352](C:\Users\nikitalystsev\AppData\Roaming\Typora\typora-user-images\image-20230614235917352.png)