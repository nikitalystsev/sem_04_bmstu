# 14. Команды работы со строками.

---

## Строковые операции: копирование, сравнение, сканирование, чтение, запись

Строка-источник - `DS:SI` (в сегменте со смещением `SI`, строка-приёмник - `ES:DI`. За один раз обрабатывается один байт (слово).

### MOVS/MOVSB/MOVSW <приёмник>, <источник>

Копирует байт или слово из приемника в источник. При использовании формы записи `MOVS` ассемблер сам определяет по типу указанных операндов, какую из трех форм выбрать, а так же разрешает заменить регистр `DS` другим с помощью префикса замены сегмента (ES:...). После выполнения команды, регистры `SI` и `DI` увеличиваются на 1 (или 2), если флаг `DF = 0`, или уменьшаются на 1 (или 2), если `DF = 1`.

### CMPS/CMPSB/CMPSW <приёмник>, <источник>

Сравнивает байт или слово из приемника с источником. После выполнения команды, регистры `SI` и `DI` увеличиваются на 1 (или 2), если флаг `DF` = 0, или уменьшаются на 1 (или 2), если `DF` = 1.

### SCAS/SCASB/SCASW <приёмник>

Сканирование (сравнение с `AL/AX`). Сравнивает содержимое `AL` (`SASB`), `AX` (`SCASW`) с байтом или словом из приемника по адресу `ES:DI`. После выполнения команды, регистры `SI` и `DI` увеличиваются на 1 (или 2), если флаг `DF = 0`, или уменьшаются на 1 (или 2), если `DF = 1`.

### LODS/LODSB/LODSW <источник>

Чтение (в `AL/AX`). После выполнения команды, регистры `SI` и `DI` увеличиваются на 1 (или 2), если флаг `DF` = 0, или уменьшаются на 1 (или 2), если `DF = 1`.

## STOS/STOSB/STOSW <приёмник>

Запись (из `AL/AX`). После выполнения команды, регистры `SI` и `DI` увеличиваются на 1 (или 2), если флаг `DF = 0`, или уменьшаются на 1 (или 2), если `DF = 1`.

Команда `REPSTOS` заполнит строку длиной в `CX` байтов (слов) значением `AL` (`AX`).

------

### Префиксы повторения строковых команд

`REP` - повторить следующую строковую операцию

`REPE` - повторить следующую строковую операцию, если равно

`REPZ` - Повторить следующую строковую операцию, если нуль

`REPNE` - повторить следующую строковую операцию, если не равно

`REPNZ` - повторить следующую строковую операцию, если не нуль

Префиксы `REP`, `REPE` и `REPNE` применяются со строковыми операциями. Каждый префикс заставляет строковую команду, которая следует за ним, повторяться указанное в регистре счетчике (`E`)`CX` количество раз или, кроме этого, (для префиксов `REPE` и `REPNE`) пока не встретится указанное условие во флаге `ZF`.

Любой из префиксов выполняет следующую за ним команду строковой обработки столько раз, сколько указано в регистре `CX`, уменьшая его на 1 после каждого выполнения команды. Если `CX` становится равным 0, то выполнение команды прекращается.

Кроме того, команды `REPE` и `REPZ` прекращают повторения, если флаг `ZF` становится равным 0, а команды `REPNE` и `REPNZ` - если `ZF` становится равным 1.

Мнемоники `REPZ` и `REPNZ` являются синонимами префиксов `REPE` и `REPNE` соответственно и имеют одинаковые с ними коды. Префиксы `REP` и `REPE` / `REPZ` также имеют одинаковый код, конкретный тип префикса задается неявно той командой, перед которой он применен.

Все описываемые префиксы применяются только к одной строковой команде за один раз. Чтобы повторить блок команд, используется команда `LOOP` или другие циклические конструкции.

Затрагиваемые флаги: `OF`, `DF`, `IF`, `TF`, `SF`, `ZF`, `AF`, `PF`, `CF`